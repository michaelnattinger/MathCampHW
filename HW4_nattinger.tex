% !TEX TS-program = pdflatex
% !TEX encoding = UTF-8 Unicode

% This is a simple template for a LaTeX document using the "article" class.
% See "book", "report", "letter" for other types of document.

\documentclass[11pt]{article} % use larger type; default would be 10pt

\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)

%%% PAGE DIMENSIONS
\usepackage{geometry} % to change the page dimensions
\geometry{a4paper} % or letterpaper (US) or a5paper or....

\usepackage{graphicx} % support the \includegraphics command and options

\usepackage{amssymb}
\usepackage{amsmath}
%%% PACKAGES
\usepackage{booktabs} % for much better looking tables
\usepackage{array} % for better arrays (eg matrices) in maths
\usepackage{paralist} % very flexible & customisable lists (eg. enumerate/itemize, etc.)
\usepackage{verbatim} % adds environment for commenting out blocks of text & for better verbatim
\usepackage{subfig} % make it possible to include more than one captioned figure/table in a single float
% These packages are all incorporated in the memoir class to one degree or another...

%%% HEADERS & FOOTERS
\usepackage{fancyhdr} % This should be set AFTER setting up the page geometry
\pagestyle{fancy} % options: empty , plain , fancy
\renewcommand{\headrulewidth}{0pt} % customise the layout...
\lhead{}\chead{}\rhead{}
\lfoot{}\cfoot{\thepage}\rfoot{}

%%% SECTION TITLE APPEARANCE
\usepackage{sectsty}
\allsectionsfont{\sffamily\mdseries\upshape} % (See the fntguide.pdf for font help)
% (This matches ConTeXt defaults)

%%% ToC (table of contents) APPEARANCE
\usepackage[nottoc,notlof,notlot]{tocbibind} % Put the bibliography in the ToC
\usepackage[titles,subfigure]{tocloft} % Alter the style of the Table of Contents
\renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
\renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!

\usepackage{amsmath}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\newcount\colveccount
\newcommand*\colvec[1]{
        \global\colveccount#1
        \begin{pmatrix}
        \colvecnext
}
\def\colvecnext#1{
        #1
        \global\advance\colveccount-1
        \ifnum\colveccount>0
                \\
                \expandafter\colvecnext
        \else
                \end{pmatrix}
        \fi
}

%%% END Article customizations

%%% The "real" document content comes below...

\title{HW4}
\author{Michael B. Nattinger\footnote{I worked on this assignment with my study group: Alex von Hafften, Andrew Smith, Ryan Mather, and Tyler Welch. I have also discussed problem(s) with Emily Case, Sarah Bass, and Danny Edgel.}}

%\date{} % Activate to display a given date or no date (if empty),
         % otherwise the current date is printed 

\begin{document}
\maketitle

\section{Question 1}
Let $X,Y$ be two vector spaces such that dim $X = n$, dim $Y = m$. Then let $B = \{ x_1, \dots, x_n\} $ be a basis for $X$ and let $C = \{ y_1, \dots, y_m\}$ be a basis for $Y$. For notational convenience define $A = \{ 1 , \dots, n\} \times \{1, \dots,m \}$. For $(p,q) \in A$ consider the following linear transformation, $\mathcal{M}_{p,q}: X \rightarrow Y$, defined such that 
\begin{equation*}
\text{mtx}_{X,Y}(\mathcal{M}_{p,q}) = \begin{pmatrix}a_{1,1} & \dots  & a_{1,q} & \dots & a_{1,m} \\ \dots & \dots & \dots & \dots & \dots \\ a_{p,1} & \dots  & a_{p,q} & \dots & a_{p,m} \\ \dots & \dots & \dots & \dots & \dots \\ a_{n,1} & \dots  & a_{n,q} & \dots & a_{n,m} \end{pmatrix}
\end{equation*}
 where $a_{i,j} = 1$ for $(i,j) = (p,q),$ and $a_{i,j} = 0$ for $(i,j) \neq (p,q)$. We will show that $\{ \mathcal{M}_{p,q} \}_{(p,q) \in \mathbb{R}^2}$ is a basis of $L(X,Y).$

\underline{pf} Let $l \in L(X,Y)$. Then, $l$ is a linear transformation from $X$ to $Y$. Let $x \in X$ be arbitrary and define $y \in Y$ such that $l(x) = y$. Since $B$ and $C$ are bases for $X$ and $Y$, we can find mtx$_{X,Y}(l) = \begin{pmatrix}b_{1,1} & \dots  & b_{1,m} \\ \dots & \dots & \dots \\ b_{n,1} & \dots  & b_{n,m} \end{pmatrix}$ and mtx$_{X,Y}(l) x = y$. Notice also that $\sum_{(i,j) \in A} \left( b_{i,j} \mathcal{M}_{i,j} \right) x = y $ so $\{ \mathcal{M}_{p,q} \}_{(p,q) \in \mathbb{R}^2}$ spans $L(X,Y)$.

We will now show that $\{ \mathcal{M}_{p,q} \}_{(p,q) \in \mathbb{R}^2}$ is independent. Let $l \in L(X,Y)$ such that $l(x) = \bar{0}$ $\forall x \in X.$ Then, mtx$_{X,Y}(l) = \begin{pmatrix}c_{1,1} & \dots  & c_{1,m} \\ \dots & \dots & \dots \\ c_{n,1} & \dots  & c_{n,m} \end{pmatrix}$ where $c_{i,j} = 0$ $\forall (x,y) \in A.$ Then, the corresponding $\sum_{(i,j) \in \mathbb{R}^2} c_{i,j}\mathcal{M}_{p,q} = \sum_{(i,j) \in \mathbb{R}^2} 0 \mathcal{M}_{p,q}$ so $\{ \mathcal{M}_{p,q} \}_{(p,q) \in \mathbb{R}^2}$ is independent.
%We will show that $\mathcal{B}:= \{ \mathcal{B}_{p,q}| (p,q) \in A\}$ is a basis for $L(X,Y)$.
%
%\underline{pf} Let $l \in L(X,Y)$. Then, $l$ is a linear transformation from $X$ to $Y$. Let $x \in X$ be arbitrary and define $y \in Y$ such that $l(x) = y$. Since $B$ and $C$ are bases for $X$ and $Y$, we can write $x,y$ as $x = a_1 x_1 + \dots + a_n x_n, y = b_1 y_1 \dots b_n y_n  \Rightarrow l(a_1 x_1 + \dots + a_n x_n) = b_1 y_1 \dots b_n y_n$ for some $a_1,\dots,a_n,b_1,\dots,b_m \in \mathbb{R}.$ Now, note that if we define $c_{p,q} = \begin{cases}
%\frac{b_q}{a_p}, & a_p \neq 0 \\
%0, & a_p = 0
%\end{cases}$ $\forall (p,q) \in A,$ then $\sum\limits_{(p,q) \in A} c_{p,q} \mathcal{B}_{p,q}(x) = y$ so $\mathcal{B}$ spans $L(X,Y)$.
%
%Let $l \in L(X,Y)$ such that $l(x) = \bar{0} \in Y$ $\forall x \in X.$ Then, for all $x \in X$, $\sum\limits_{(p,q) \in A} c_{p,q} \mathcal{B}_{p,q}(x) = 0$. Notice that, for all $x \in X$, $l(x) = 0 = 0y_1 + \dots + 0y_m \Rightarrow c_{p,q} = 0$ $\forall (p,q) \in A.$ Thus, $\mathcal{B}$ is independent and, therefore, a basis for $L(X,Y)$.

\section{Question 2}
Let $T \in L(X,X)$ and $\lambda$ is $T$'s eigenvalue. Let $A = \text{mtx}_X(T)$. 

\subsection{Prove that $\lambda^k$ is an eigenvalue of $T^k$, $k \in \mathbb{N}$}
\underline{pf} We have that $Ax = \lambda x$ for some $x \in X$. Also note that mtx$_X(T^k) = A^k.$ If $\lambda = 0$ then $Ax = 0x \Rightarrow A^kx = A^{k-1}0x = 0x = 0^{k}x = \lambda^{k}$ so $\lambda^{k}$ is an eigenvalue of $T^k$. Now assume $\lambda$ is nonzero. Then $Ax = \lambda x \Rightarrow \lambda^{-1} Ax = x \Rightarrow \lambda^{-1}A \dots \lambda^{-1} A x = x \Rightarrow (\lambda^{-1})^k A^k x = x \Rightarrow A^k x = \lambda^k x$ so $\lambda^k$ is an eigenvalue of $T^k$.

\subsection{Prove that if $T$ is invertible, then $\lambda^{-1}$ is an eigenvalue of $T^{-1}$.}
\underline{pf} We have that $Ax = \lambda x$ for some $x \in X$. Then, since $T$ is invertible, $A$ is invertible and mtx$_X(T^{-1}) = A^{-1}.$ Now assume $\lambda = 0$. Then $Ax = 0x = \bar{0} \Rightarrow A^{-1} A^{-1} A x = A^{-1} A^{-1} \bar{0} = \bar{0} = 0x \Rightarrow A^{-1}x = 0 x = 0^{-1} x = \lambda^{-1} x$ so $\lambda^{-1}$ is an eigenvalue of $T^{-1}.$ 

Next, assume $\lambda \neq 0.$ Then, $x = \lambda A^{-1}x \Rightarrow \lambda^{-1} x = A^{-1}x$ so $\lambda^{-1}$ is an eigenvalue of $T^{-1}$.

\subsection{Define an operator $S: X \rightarrow X$ such that $S(x) = T(x) - \lambda x$ $\forall x \in X$. Is $S$ linear? Prove that ker $S:= \{ x \in X | S(x) = \bar{0}\}$ is a vector space.}
\underline{pf} Let $a,b \in \mathbb{R}, x,y \in X.$ $S(ax + by) = T(ax + by) - \lambda(ax+by) = aT(x) + bT(y) - \lambda a x - \lambda b y = a(T(x) - \lambda x) + b(T(y) - \lambda y) = aS(x) + bS(y)$ so $S$ is linear.

Note that, for $x \in $ ker $S,$ $S(x) = \bar{0} \Rightarrow T(x) = \lambda x \Rightarrow Ax = \lambda x$ so $x$ is an eigenvector for $T$, or $x = \bar{0}$. Let $x,y \in $ ker$T, a,b \in \mathbb{R}.$ Then define $c:= ax +bx.$ Note that $S(c) = S(ax+by) = aS(x)+bS(y) = \bar{0}$ so ker$T$ is closed under addition and scalar multiplication. We also have that, for $x \in $ ker $T$, $z := -x \in $ ker $T$ and $x+z = \vec{0}.$ Also, $0 \in \mathbb{R}$ so $0x = \bar{0} \in$ ker$T$, and note that for any $y \in $ ker$T$, $\bar{0} + y = y+\bar{0} = y.$  Therefore, ker $T$ is a vector space.

%Thus, ker $S$ is the set of eigenvectors for $T$ corresponding to the eigenvalue $\lambda$, so ker $S$ is a vector space.\footnote{Do I need to prove this last point?}

\section{Question 3}
Let $T: \mathbb{R}^2 \rightarrow \mathbb{R}^2$ be given by $T(x,y) = (x-y,2x+3y).$ Let $W$ be the standard basis of $\mathbb{R}^2$ and let $V$ be another basis of $\mathbb{R}^2$, $V = \{(1,-4),(-2,7) \}$ in the coordinate of $W$.
\subsection{Find mtx$_W(T).$}
$T = (x-y)e_1 + (2x +3y) e_2 = x(e_1 + 2e_2) + y(-e_1 + 3e_2)$. Thus, mtx$_W(T) = 
\begin{pmatrix}
1 & -1 \\
2 & \text{ }3 
\end{pmatrix}$. 

\subsection{Find mtx$_V(T).$}
mtx$_V(T) = $ mtx$_{W,V}(id)^{-1} $ mtx$_W(T)$ mtx$_{W,V}(id)$ so we first need to find mtx$_{W,V}(id)$.

To find mtx$_{W,V}(id)$ we find a matrix which maps $\{\colvec{2}{1}{0} \colvec{2}{0}{1}\}$ to $\{ \colvec{2}{1}{-4} \colvec{2}{-2}{7} \}$. Note that this is trivially $
\begin{pmatrix}
1 & -2\\
-4 & 7
\end{pmatrix} = P$. We then have \\
mtx$_V(T) = $ mtx$_{W,V}(id)^{-1} $ mtx$_W(T)$ mtx$_{W,V}(id) = P^{-1}$ mtx$_W(T)P = 
\begin{pmatrix}
-15 & 29 \\
-10 & 19
\end{pmatrix}.
$
\subsection{Find $T(1,-2)$ in the basis $V$.}
%Note that $T(1,-2) = (3,-4)$ so we simply need to find $a,b \in \mathbb{R}$ such that $ a(1,-4) + b(-2,7) = (3,-4)$. Note that if $a^{*} =-13$ and $b^{*} = -8$, then $a^{*}(1,-4) + b^{*}(-2,7) = (-13,52) + (16,-56) = (3,-4)$ so therefore $T(1,-2)$, in the basis of $V$, is $(-13,-8)$.\footnote{The verified solution was found via Matlab.}
In the basis of V, $T(1,-2) = $ mtx$_{V}(T) \colvec{2}{1}{-2} = \colvec{2}{-73}{-48}$.

\section{Question 4}
We will solve the linear first order difference equations as described. We will specifically be solving the following system:

$X_t = \begin{pmatrix} 1&4 \\ 2&-1\end{pmatrix} X_{t-1}, X_0 = \colvec{2}{1}{1}.$

\subsection{Calculate eigenvalues and eigenvectors of A}
For eigenvalues $\lambda$ of $A$ must satisfy det$(A - \lambda I) = 0.$ Then, $ (1- \lambda)(-1 - \lambda) - (4)(2) = 0 \Rightarrow \lambda^2 - 9 = 0 \Rightarrow \lambda = 3$ and $\lambda = -3.$ Thus, $3,-3$ are eigenvalues of $A$. Now we must find their corresponding eigenvectors.

First let us find $x$ such that $Ax = 3x$. Then, $x_1 + 4x_2 = 3x_1, 2x_1 - 1x_2 = 3x_2 \Rightarrow -2x_1 + 4x_2 = 0 = 2x_1 - 4x_2 \Rightarrow \colvec{2}{2}{1}$ is an eigenvector corresponding to an eigenvalue of $3$. Similarly, we will find $x$ such that $Ax = -3x \Rightarrow x_1 + 4x_2 = -3x_1, 2x_1 - 1x_2 = -3x_2 \Rightarrow x_1 + x_2 = 0 = 2x_1 + 2x_2 \Rightarrow \colvec{2}{1}{-1}$ is an eigenvector corresponding to an eigenvalue of $-3$.

\subsection{Set $D = diag\{ \lambda_1 \dots \lambda_n \}$ and $P = \{ v_1, \dots, v_n\}.$}

We define $D = \begin{pmatrix}3& 0 \\ 0& -3\end{pmatrix}$. We also define $P  = \begin{pmatrix}2& 1 \\ 1& -1\end{pmatrix}$.

\subsection{Calculate $P^{-1}$ and $Pdiag\{ \lambda_{1}^{t}, \dots, \lambda_{n}^{t} \} P^{-1}.$}
We can calculate $P^{-1} = \frac{1}{-2 - 1} \begin{pmatrix}-1& -1 \\ -1& 2\end{pmatrix} =  \begin{pmatrix}1/3& 1/3 \\ 1/3& -2/3\end{pmatrix} $. $A^t = Pdiag\{ \lambda_{1}^{t}, \dots, \lambda_{n}^{t} \} P^{-1} =  \begin{pmatrix}2& 1 \\ 1& -1\end{pmatrix} \begin{pmatrix}3^t& 0 \\ 0& (-3)^t\end{pmatrix} \begin{pmatrix}1/3& 1/3 \\ 1/3& -2/3\end{pmatrix} $

\subsection{Plug $A^t$ from step 3 to solve for $X_t$.}
$X_t = A^t X_0 = \begin{pmatrix}2& 1 \\ 1& -1\end{pmatrix} \begin{pmatrix}3^t& 0 \\ 0& (-3)^t\end{pmatrix} \begin{pmatrix}1/3& 1/3 \\ 1/3& -2/3\end{pmatrix} \colvec{2}{1}{1} = \begin{pmatrix}2& 1 \\ 1& -1\end{pmatrix} \begin{pmatrix}3^t& 0 \\ 0& (-3)^t\end{pmatrix} \colvec{2}{2/3}{-1/3} = \begin{pmatrix}2& 1 \\ 1& -1\end{pmatrix}   \begin{pmatrix}2(3^{t-1}) \\  (-3)^{t-1}\end{pmatrix} =  \begin{pmatrix}4(3^{t-1}) + (-3)^{t-1} \\ 2(3^{t-1}) - (-3)^{t-1}\end{pmatrix}$

\section{Question 5}
We want to find a sequence of real numbers $\{z_{t}\}_{t=1}^{\infty}$, which satisfies
\begin{equation}
z_t = a_1 z_{t-1} + \dots + a_{n} z_{t-n} \label{eqn:zs}
\end{equation}
where $a_1, \dots , a_n \in \mathbb{R}$ and $z_0, \dots, z_{-n+1} \in \mathbb{R}$ are given.

We define $X_t := \colvec{4}{z_t}{z_{t-1}}{\dots}{z_{t-n+1}}.$ We now write $X_t = A X_{t-1}$ for some $n \times n$ matrix $A$. Now, notice that we have: 
\begin{equation*}
\colvec{4}{z_t}{z_{t-1}}{\dots}{z_{t-n+1}} = A  \colvec{4}{z_{t-1}}{z_{t-2}}{\dots}{z_{t-n}} = \begin{pmatrix} a_{1,1} z_{t-1} + a_{1,2}z_{t-2} + \dots + a_{1,n} z_{t-n}\\a_{2,1} z_{t-1} + a_{2,2}z_{t-2} + \dots + a_{2,n} z_{t-n} \\\dots  \\a_{n,1} z_{t-1} + a_{n,2}z_{t-2} + \dots + a_{n,n} z_{t-n} \end{pmatrix}.
\end{equation*}

From \ref{eqn:zs} we have that $a_{1,i} = a_i$ $\forall i \in \{ 1, \dots, n \}$. Notice also that  $\forall j \in \{ 1, \dots, n-1\}$, $a_{j+1,j} = 1$ and $a_{j+1,k} =0$ for $k \neq j$. Thus,
\begin{equation*}
A = \begin{pmatrix}
a_1 &a_2 &\dots & a_{n-1} & a_n \\ 1 & 0 & \dots & 0 & 0 \\ 0 & 1 & \dots & 0 & 0 \\ \dots & \dots & \dots & \dots & \dots \\   0 & 0 & \dots & 1 & 0
\end{pmatrix}.
\end{equation*}

Next, we know that, for all $t$, $z_t = c_1 \lambda_{1}^{t} + \dots + c_n \lambda_{n}^{t}$ for coefficients $c_1, \dots c_n$. We are given values for $z_0, \dots z_{-n+1}$ so we can use our expression for $z_t$ to set up a system which will identify our coefficients:

\begin{equation*}
\colvec{3}{z_0}{\dots}{z_{-n+1}} = \colvec{3}{c_1 \lambda_{1}^{0} + \dots + c_n \lambda_{n}^{0}}{\dots}{c_1 \lambda_{1}^{-n+1} + \dots + c_n \lambda_{n}^{-n+1}}
\end{equation*} 

\subsection{Applying this methodology}

Let $n=3, a_1 = 2, a_2 = 1, a_3 = -2, z_0 = 2, z_{-1} = 2, z_{-2} = 1$.

Then, $A = \begin{pmatrix} 2 & 1 & -2\\1 & 0 & 0 \\ 0 & 1 & 0 \end{pmatrix}$. We will now find our eigenvalues of $A$. These satisfy $det(A - \lambda I) = 0$
\begin{equation*}
\Rightarrow (2- \lambda)(\lambda^2) + \lambda - 2 = (\lambda - 1)(\lambda - 2)(\lambda+1)
\end{equation*}
so the eigenvalues of $A$ are $2,1,-1.$ Now, we do not need to find eigenvectors. Rather, we can set up our initial value equations:

\begin{equation*}
\colvec{3}{z_0}{z_{-1}}{z_{-2}} = \colvec{3}{c_1 \lambda_{1}^{0} + c_2 \lambda_{2}^{0} + c_3 \lambda_{3}^{0}}{c_1 \lambda_{1}^{-1} + c_2 \lambda_{2}^{-1} + c_3 \lambda_{3}^{-1}}{c_1 \lambda_{1}^{-2} + c_2 \lambda_{2}^{-2} + c_3 \lambda_{3}^{-2}} =
\colvec{3}{c_1 + c_2 + c_3 }{c_1 2^{-1} + c_2 1^{-1} + c_3 (-1)^{-1}}{c_1 2^{-2} + c_2 1^{-2} + c_3 (-1)^{-2}}
\end{equation*} 
\begin{equation*}
\Rightarrow \colvec{3}{2}{2}{1} = \begin{pmatrix} 1 & 1 & 1 \\ 1/2 & 1 & -1 \\ 1/4 & 1 & 1  \end{pmatrix} \colvec{3}{c_1}{c_2}{c_3} \Rightarrow \colvec{3}{c_1}{c_2}{c_3} = \colvec{3}{4/3}{1}{-1/3}.
\end{equation*}

Now we can find our solution: $z_t = \frac{4}{3}(2)^t + 1^t - \frac{1}{3}(-1)^t = \frac{4}{3}(2)^t + 1 - \frac{1}{3}(-1)^t.$
\end{document}
